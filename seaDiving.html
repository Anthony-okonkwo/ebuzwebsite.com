<!-- Created by lolo --><!--    NAME : SEA DIVING    DATE : August 12, 2020    AUTHOR : lolo--><!DOCTYPE html><html>    <head>        <title>SEA DIVING</title>        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">        <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@700&display=swap" rel="stylesheet">    <link rel="stylesheet" href="seaDiving.css">    </head>    <body>    <script>        // Created by lolo"use strict";let W, H, c, ctx;let checkVibrate;let intervalBar, intervalBubble, intervalCoin, intervalBomb, intervalFish, intervalTimer; let bubbles = [], coins = [], bombs = [], arrows = [], fishs = [];let imgCoin, imgBomb, imgFish, imgArrow;let statePower = false, playing = false;let cptBar = 0;let posImg = {x:0, y:0};let valueDirection = 0;let scoreCoin = 0, scoreFish = 0;let numArrow = 3;let life = 100;let timer = 120;class Dot{    constructor(x,y,r){        this.x = x;        this.y = y;        this.r = r;    }}class Bubble extends Dot {    constructor(x,y,r) {        super(x,y,r);    }    draw() {        ctx.beginPath();        ctx.fillStyle = '0362E8';        ctx.strokeStyle = 'white';        ctx.lineWidth = 0.5;        ctx.arc(this.x, this.y, this.r, 0, 2 * Math.PI);        ctx.fill();        ctx.stroke();    }    update() {        this.x--;        this.draw();    }} class Coin extends Dot {    constructor(x,y,r) {        super(x,y,r);    }    draw() {        ctx.beginPath();        ctx.drawImage(imgCoin, this.x-this.r/2, this.y-this.r/2, this.r, this.r);    }    update() {        this.y+=0.5;        this.draw();    }} class Bomb extends Dot {    constructor(x,y,r,a) {        super(x,y,r);        this.a = a;    }    draw() {        ctx.beginPath();        ctx.drawImage(imgBomb, this.x-this.r/2, this.y-this.r/2, this.r, this.r);    }    update() {        this.a += 0.01;        if(this.x + 0.5*Math.cos(this.a)<W-50&&this.x + 0.5*Math.cos(this.a)>50){            this.x += 0.5 *Math.cos(this.a);        }        this.y++;        this.draw();    }}class Fish extends Dot {    constructor(x,y,r) {        super(x,y,r);    }    draw() {        ctx.beginPath();        ctx.drawImage(imgFish, this.x-this.r/2, this.y-this.r/2, this.r, this.r);    }    update() {        this.xst = posImg.x+20;        this.yst = c.height + 100;        this.x = util.moveFish(this.x, this.xst, 0.01);        this.y = util.moveFish(this.y, this.yst, 0.01);        this.draw();    }}class Shoot{    constructor() {        this.x = posImg.x+20;        this.y = c.height - 50;        this.w = 20;    }    draw() {        ctx.beginPath();        ctx.drawImage(imgArrow, this.x-this.w/2, this.y-this.w/2, this.w, this.w);    }    update() {        this.y-=5;        this.draw();    }}const util = {    newGradient(c1, c2){        let NG;        NG = ctx.createLinearGradient(0, 0, W, 0);        NG.addColorStop(0, c1);        NG.addColorStop(1, c2);        return NG;    },    random(max=1, min=0){        return Math.random() * (max - min) + min;    },    collision(x0,y0,x1,y1,r){        return Math.hypot(x0-x1, y0-y1) < r ? true : false;    },    moveFish(a,b,c){        return a+(b-a)*c;    }};const check = () => {    for(let a = bubbles.length - 1; a >= 0; a--){        bubbles[a].update();        if(bubbles[a].x<30)bubbles.splice(a, 1);    }            for(let b = coins.length - 1; b >= 0; b--){            coins[b].update();            if(coins[b].y>c.height)coins.splice(b, 1);            else if(util.collision(coins[b].x, coins[b].y, posImg.x+10, c.height - 40, 40)){                coins.splice(b, 1);                scoreCoin++;                updateScores(scorecoin,2);            }    }            for(let c = arrows.length - 1; c >= 0; c--){        arrows[c].update();        if(arrows[c].y<-50)arrows.splice(c, 1);    }            for(let d = bombs.length - 1; d >= 0; d--){        bombs[d].update();        if(bombs[d].y>c.height+30)bombs.splice(c, 1);        else if(util.collision(bombs[d].x, bombs[d].y, posImg.x+10, c.height - 40, 40)){            bombs.splice(d, 1);            life -= 20;            updateScores(outputlife,1.15);            if(checkVibrate)navigator.vibrate(300);        }    }            for(let e = fishs.length - 1; e >= 0; e--){        fishs[e].update();        if(fishs[e].y>c.height+30)fishs.splice(e, 1);        else if(util.collision(fishs[e].x, fishs[e].y, posImg.x+10, c.height - 40, 45)){            fishs.splice(e, 1);            life -= 20;            updateScores(outputlife,1.15);            if(checkVibrate)navigator.vibrate(300);        }        else{            for(let i = arrows.length - 1; i >= 0; i--){                if(fishs.length>0){                    if(util.collision(fishs[e].x, fishs[e].y,arrows[i].x, arrows[i].y, 20)){                        fishs.splice(e, 1);                        arrows.splice(i, 1);                        scoreFish++;                        updateScores(scorefish,2);                    }                }            }        }    }        if(timer<=0)end("GAME OVER");    else if(life<1)end("YOU LOSE");};const end = (x) =>{    playing = false;    stopAllInterval();    clear();    imggif.style.display =  'none';    canvas.style.filter = 'blur(3px)';    gameover.style.display =  'block';    outputgameover.innerHTML = x;};const updatePlayer = () => {    if(posImg.x+valueDirection>20&&posImg.x+valueDirection<W-60)posImg.x += valueDirection ;    imggif.style.left =  posImg.x + 'px';};const clear = () => {    ctx.fillStyle = util.newGradient('#0362E8','#02224F');    ctx.fillRect(0, 0, W, H);};const displayArrow = () => {    ctx.beginPath();    for(let i=0; i<numArrow; i++){        ctx.drawImage(imgArrow, c.width-20, c.height - 25 - i*25, 20, 20);    }};const updateTimer = () => {    timer--;    time.innerHTML = timer;};const updateScores = (obj, scale) => {    scorecoin.innerHTML = scoreCoin;    scorefish.innerHTML = scoreFish;    barlife.style.height = life + "%";    obj.style.transform = 'scale(' + scale + ')';    setTimeout(function() { obj.style.transform = 'scale(1)'; }, 300);};const animate = () => {    if(playing){        clear();        displayArrow();        updatePlayer();        check();        wave.draw();    }                    requestAnimationFrame(animate);};const wave = {    x: 20,    amplitude: 2,    frequency: 0.2,    wavelength: 0.015,    speed: null,     waveChange: 0,    draw() {        this.speed += this.frequency;        this.waveChange++;        if(this.waveChange > 100) {            this.waveChange = 0;            this.amplitude = util.random(15);        }        ctx.beginPath();        ctx.strokeStyle = 'white';        ctx.lineWidth = 1;        for(let i=0; i <c.height ; i++) {            let wave = Math.sin(i * this.wavelength + this.speed);            ctx.moveTo(0, i);            ctx.lineTo(this.x + wave * this.amplitude, i );        }        ctx.stroke();        ctx.closePath();    }};const power = () => {    statePower = statePower ? false : true;    btnpower.style.color = statePower ? '#119C02' : '#C81414';    posImg.x = W/2 - 35    posImg.y = 110;    statePower ? on() : off();};const on = () => {    loader.style.display = 'block';    intervalBar = setInterval(barLoder,10);};const stopAllInterval = () => {    clearInterval(intervalBubble);    clearInterval(intervalCoin);    clearInterval(intervalBomb);    clearInterval(intervalFish);    clearInterval(intervalTimer);};const reinitValues = () => {    stopAllInterval();    bubbles = [];    coins = [];    bombs = [];    fishs = [];    playing = false;    cptBar = 0;    scoreCoin = 0;    scoreFish = 0;    life = 100;    timer = 120;    canvas.style.filter = 'blur(0px)';    scorecoin.innerHTML = scoreCoin;    scorefish.innerHTML = scoreFish;    barlife.style.height = life + "%";};const off = () => {    ctx.fillStyle = '#000';    ctx.fillRect(0, 0, W, H);    first.style.display = 'none';    loader.style.display = 'none';    imggif.style.display = 'none';    time.style.display = 'none';    outputcoin.style.display = 'none';    outputfish.style.display = 'none';    outputlife.style.display = 'none';    bar.style.width = cptBar + '%';    barlife.style.height = '100%';    gameover.style.display = 'none';    reinitValues();};const barLoder = () => {    bar.style.width = cptBar + '%';    cptBar++;    if(cptBar>=100){        first.style.display = 'block';        loader.style.display = 'none';        clearInterval(intervalBar);    }};const start = () => {    first.style.display = "none";    outputcoin.style.display = 'flex';    outputfish.style.display = 'flex';    outputlife.style.display = 'block';    time.style.display = 'block';    imggif.style.display = 'block';    gameover.style.display = 'none';    reinitValues();    createBubble();    createCoin();    createBomb();    createFish();    intervalTimer = setInterval(updateTimer, 1000);    playing = true;};const up = () =>{    valueDirection = -2;    imggif.style.transform = 'rotateX(180deg)rotate(-80deg)translateZ(-10px)';};const down = () =>{    valueDirection = 2;    imggif.style.transform = 'rotateX(180deg)rotate(-110deg)translateZ(-10px)';};const stop = () =>{    valueDirection = 0;    imggif.style.transform = 'rotateX(180deg)rotate(-90deg)translateZ(-10px)'};const shoot = () => {    if(numArrow>0){        numArrow--;        arrows.push(new Shoot());        setTimeout(function() { numArrow++; }, 3000 + numArrow*1000 );    }};const createBubble = () => {    let x = posImg.x;    let y = c.height - 50 + util.random(10,-10);    let r = util.random(3,1);    bubbles.push(new Bubble(x,y,r));        clearInterval(intervalBubble);    let nextInterval = util.random(1500,100);    intervalBubble = setInterval(createBubble, nextInterval);};const createCoin = () => {    let x = W - ~~util.random(W-100, 50);    let y = -50;    let r = 30;    coins.push(new Coin(x,y,r));      let newInterval = ~~util.random(6000, 3500);   clearInterval(intervalCoin);   intervalCoin = setInterval(createCoin, newInterval);};const createFish = () => {    let x = W - ~~util.random(W-100, 50);    let y = -50;    let r = 50;    fishs.push(new Fish(x,y,r));      let newInterval = ~~util.random(6000, 3000);   clearInterval(intervalFish);   intervalFish = setInterval(createFish, newInterval);};const createBomb = () => {    let x = ~~util.random(W-50, 50);    let y = ~~util.random(-100,-50);    let r = 40;    let a = util.random(Math.PI*2);    bombs.push(new Bomb(x,y,r,a));      let newInterval = ~~util.random(3000, 1000);   clearInterval(intervalBomb);   intervalBomb = setInterval(createBomb, newInterval);};const posCMD = () => {    loader.style.width = (H - 220 - 20) +'px';    c.width = W - 20;    c.height = H - 220;    c.style.left = '10px';        cmdleft.style.bottom = '10px';    cmdleft.style.left = '10px';    cmdleft.style.width = (W - 20) + 'px';        cmdright.style.top = '10px';    cmdright.style.left = '10px';    cmdright.style.width = (W - 20) + 'px';        posImg.x = W/2 - 35;    posImg.y = 110 + c.height - 80;    imggif.style.left =  posImg.x + 'px';    imggif.style.top = posImg.y + 'px';        outputcoin.style.left = "-5px"    outputcoin.style.top = 110 + c.height-45 + "px";    outputcoin.style.transform = "rotate(-90deg)"        outputfish.style.left = "20px"    outputfish.style.top = 110 + c.height-45 + "px";    outputfish.style.transform = "rotate(-90deg)";        time.style.left = "0px"    time.style.top = 100 + c.height/2 + "px";    time.style.transform = "rotate(-90deg)";};const createImg = () => {    imgCoin = new Image();    imgCoin.src = "https://i.ibb.co/QKpBHtv/token.png";    imgBomb = new Image();    imgBomb.src = "https://i.ibb.co/SdqfDz6/mine.png";    imgArrow = new Image();    imgArrow.src = "https://i.ibb.co/SJcn8GB/bow.png";    imgFish = new Image();    imgFish.src = "https://i.ibb.co/kSGCLv0/pirana.png";};const eventsListener = () => {    btnpower.addEventListener("click", () => power() );    document.getElementsByClassName('ca')[0].addEventListener("touchstart", () => shoot() );    document.getElementsByClassName('up')[0].addEventListener("touchstart", () => up() );    document.getElementsByClassName('up')[0].addEventListener("touchend", () => stop() );    document.getElementsByClassName('down')[0].addEventListener("touchstart", () => down() );    document.getElementsByClassName('down')[0].addEventListener("touchend", () => stop() );    document.getElementsByClassName('fa-play-circle')[0].addEventListener("click", () => start() );    document.getElementsByClassName('fa-play-circle')[1].addEventListener("click", () => start() );};const init = () => {    checkVibrate = window.navigator && window.navigator.vibrate;        c = document.getElementById("canvas");    W = window.innerWidth;    H = window.innerHeight;    ctx = c.getContext("2d");    posCMD();    createImg();    eventsListener();    requestAnimationFrame(animate);};onload = init;    </script>        <canvas id="canvas"></canvas>        <div id="first">            <h1 style="color:#F0ECEF">SEA DIVING</h1>            <p style="color:#1DCA04">Catch the coins and kill as many fish as possible !</p>            <p><i style="font-size:0.7em;color:#E90303">Be careful not to touch the mines and fish !</i></p>            <i class="fas fa-play-circle fa-4x"></i>        </div>        <div id="loader">LOADING<div id="bar"></div></div>        <div id="gameover">            <span id="outputgameover"></span><br>            <i class="fas fa-play-circle fa-2x" style="margin-top:30px"></i>        </div>        <div id="time">120</div>        <div id="cmdleft">            <div class="cmd up"><i class="fas fa-chevron-left"></i></div>            <div class="cmd down"><i class="fas fa-chevron-right"></i></div>        </div>        <div id="cmdright">            <div class="cmd btns power" id="btnpower"><i class="fas fa-power-off"></i></div>            <div class="cmd ca">X</div>        </div>        <img src="https://i.ibb.co/hBpfV79/gif.gif" id="imggif">        <div id="outputcoin">            <img src="https://i.ibb.co/QKpBHtv/token.png" id="imgcoin">            <span id="scorecoin">0</span>        </div>        <div id="outputfish">            <img src="https://i.ibb.co/kSGCLv0/pirana.png" id="imgfish">            <span id="scorefish">0</span>        </div>        <div id="outputlife">            <div id="barlife"></div>        </div>    </body></html>